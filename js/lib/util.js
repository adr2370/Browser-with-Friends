Array.prototype.remove=function(){var e;var c=arguments;var b=c.length;var d;while(b&&this.length){e=c[--b];while((d=this.indexOf(e))!=-1){this.splice(d,1);}}return this;};var ResponseHeaders=function(c){try{if(IsDefined(c)){var f=0,g=1;var k=c.split("\r\n").remove("");var a;for(var d=0,b=k.length;d<b;++d){a=k[d].split(": ");this[a[f]]=a[g];}}}catch(h){var j="ResponseHeaders, IsDefined:"+typeof IsDefined+",Remove:"+typeof[].remove;if(typeof Reports!=="undefined"){Reports.error(ErrorMessage(h,j));}}return this;};var Class=function(a){return function(){for(var b in a){if(a.hasOwnProperty(b)){this[b]=a[b];}}if(typeof(this["initialize"])==="function"){this.initialize.apply(this,arguments);}};};var XHR=new Class({initialize:function(a){try{this.options=a;this._method=(this.options.method||"get").toUpperCase();this._data=this.options.data||null;this._type=a.type||"text";this._async=a.async;this._xhr=new XMLHttpRequest();this._xhr.open(this._method,this.options.url,this.options.async);this._is_called_failure_callback=false;if(this._method==="POST"){this._xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");}return this;}catch(b){this._TEMP_HELPER_INVALID_STATE_ERR_EXCEPTION(b,"initialize");}},_getHeadersObject:function(){var a=undefined;try{var c=this._xhr.getAllResponseHeaders();if(IsDefined(c)){a=new ResponseHeaders(c);}}catch(b){this._TEMP_HELPER_INVALID_STATE_ERR_EXCEPTION(b,"_headersToObject,IsDefined:"+typeof IsDefined+",ResponseHeaders:"+typeof ResponseHeaders);}return a;},_onReadyStateChange:function(){try{if(this._xhr.readyState===4){if(this._xhr.status===200||(!this._async&&this._xhr.status===0)){var a=this._xhr[this._type==="xml"?"responseXML":"responseText"];if(this.options.async&&typeof this.options.callback==="function"){var c=this._getHeadersObject();this.options.callback({call:"success",response:a,responseHeaders:c});}else{return a;}}else{if(this.options.async&&typeof this.options.callback==="function"){this._callFailureCallback(this._xhr.status);}else{return null;}}}}catch(b){this._TEMP_HELPER_INVALID_STATE_ERR_EXCEPTION(b,"_onReadyStateChange");}},_handleSendException:function(b){var a="XHR EXCEPTION: "+b.message+", CODE: "+b.code+"\nURL: "+this.options.url+", METHOD: "+this.options.method+", IS ASYNC: "+this.options.async;if(typeof(Crossrider)!=="undefined"){Crossrider.Utils.internalDebug(a);}this._callFailureCallback(b);},_callFailureCallback:function(b){try{if(this.options.async&&this.options.hasOwnProperty("callback")&&typeof this.options.callback==="function"&&!this._is_called_failure_callback){this._is_called_failure_callback=true;this.options.callback({call:"failure",response:b});}}catch(a){this._TEMP_HELPER_INVALID_STATE_ERR_EXCEPTION(a,"_callFailureCallback");}},_TEMP_HELPER_INVALID_STATE_ERR_EXCEPTION:function(b,a){if(typeof Reports!=="undefined"){Reports.error(ErrorMessage(b,a));}},send:function(){try{if(this.options.async){try{this._xhr.onreadystatechange=this._onReadyStateChange.bind(this);this._xhr.send(this._data);}catch(a){this._handleSendException(a);}}else{try{this._xhr.send(this._data);}catch(a){this._handleSendException(a);return null;}return this._onReadyStateChange();}}catch(a){this._TEMP_HELPER_INVALID_STATE_ERR_EXCEPTION(a,"send");}}});
